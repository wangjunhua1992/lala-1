webpackJsonp([101],{TqM7:function(e,t){},e23f:function(e,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d("Gu7T"),i=d.n(a),o=d("Dd8w"),s=d.n(o),c=d("Cz8s"),l=d("mzkE"),y=d("kEnp"),r=d("NYxO"),g={data:function(){return{sid:0,cid:0,showPreLoading:!0,styleContent:"#fff",is_grant:0,title:"",active:1,diydata:{diy:{data:{},fixedsearch:{},is_has_goodsTab:0,is_has_location:0,is_has_storebasic:0,storebasic_style:1},superRedpacketData:{errno:0,message:{},is_show:!0},config:{},categorySelectedIndex:0,categorySelectedId:0,categoryAll:[],categorySelected:{child:[{}]},childSelectedIndex:0,childSelectedId:0,goodsAll:[],goodsItem:{orderby:{type:"",value:""}},goodsLoading:!0,store:{},shopPage:{},vanColHeight:667},store:{},menufooter:{}}},components:{PublicHeader:c.a,PublicFooter:l.a,diy:y.a},computed:s()({},Object(r.c)(["istore","icart"])),methods:s()({},Object(r.b)(["setLocation","getLocation","replaceStore","replaceCart"]),{onLoad:function(){var e=this;this.util.request({url:"wmall/shop/category",data:{sid:this.sid,cid:this.cid,menufooter:1}}).then(function(t){e.showPreLoading=!1,e.diydata.goodsLoading=!1;var d=t.data.message;d.errno?e.$toast(d.message):(e.diydata.config=d.message.config_mall,e.diydata.diy=e.util.extend(e.diydata.diy,d.message.diy),e.styleContent={"background-color":e.diydata.diy.data.page.background},e.diydata.superRedpacketData=d.message.superRedpacketData,e.diydata.superRedpacketData.is_show=!0,e.util.setWXTitle(e.title),e.menufooter=window.menufooter,e.cart=d.message.cart.message.cart,e.store=d.message.store,e.replaceStore(e.store),e.replaceCart(e.cart),e.store=d.message.store,e.title=e.store.title||"门店首页",1==e.diydata.diy.is_has_storebasic&&(e.diydata.categoryAll=d.message.category,e.diydata.goodsItem={page:2,psize:30,empty:0,data:d.message.goods,orderby:{type:"",value:""}},e.diydata.goodsItem.data.length<e.diydata.goodsItem.psize&&(e.diydata.goodsItem.loaded=!0,e.diydata.goodsItem.data.length||(e.diydata.goodsItem.empty=1)),e.diydata.categorySelectedId=d.message.cid,e.diydata.childSelectedId=d.message.child_id,e.diydata.categorySelectedIndex=d.message.cindex,e.diydata.goodsAll[e.diydata.categorySelectedIndex]=[],e.diydata.goodsAll[e.diydata.categorySelectedIndex][e.diydata.childSelectedIndex]=e.diydata.goodsItem,e.diydata.categorySelected=d.message.category[e.diydata.categorySelectedIndex]||{},e.diydata.store=e.store,e.diydata.shopPage=e.store.data.shopPage))})},onToggleCategory:function(e){e.cid;var t=e.index,d=0;"child"==e.from?(d=t,this.diydata.childSelectedIndex=d,this.diydata.categoryAll[this.diydata.categorySelectedIndex].childSelectedIndex=d,this.diydata.categorySelected=this.diydata.categoryAll[this.diydata.categorySelectedIndex]):(this.diydata.categoryAll[t].childSelectedIndex>0&&(d=this.diydata.categoryAll[t].childSelectedIndex),this.diydata.categorySelected=this.diydata.categoryAll[t],this.diydata.categorySelectedIndex=t,this.diydata.childSelectedIndex=d,this.diydata.categoryAll[t].childSelectedIndex=d),this.diydata.categorySelectedId=this.diydata.categorySelected.id,this.diydata.childSelectedId=0,this.diydata.categorySelected.child&&this.diydata.categorySelected.child.length>0&&(this.diydata.childSelectedId=this.diydata.categorySelected.child[d].id),this.onGetGoods()},onGetGoods:function(){var e=this;if(this.diydata.goodsLoading,this.diydata.goodsAll[this.diydata.categorySelectedIndex]||(this.diydata.goodsAll[this.diydata.categorySelectedIndex]=[]),this.diydata.goodsItem=this.diydata.goodsAll[this.diydata.categorySelectedIndex][this.diydata.childSelectedIndex],this.diydata.goodsItem){if(this.diydata.goodsItem.empty)return!1;if(this.diydata.goodsItem.loaded)return console.log("商品全部加载完成"),!1}else this.diydata.goodsItem={page:1,psize:30,empty:0,loaded:!1,data:[],orderby:{type:"",value:""}};this.diydata.goodsLoading=!0,this.util.request({url:"wmall/store/goods/goods",data:{sid:this.sid,page:this.diydata.goodsItem.page,psize:this.diydata.goodsItem.psize,cid:this.diydata.categorySelectedId,child_id:this.diydata.childSelectedId,type:this.diydata.goodsItem.orderby.type,value:this.diydata.goodsItem.orderby.value}}).then(function(t){e.diydata.goodsLoading=!1;var d=t.data.message.message;e.diydata.goodsItem.data=[].concat(i()(e.diydata.goodsItem.data),i()(d.goods)),e.diydata.goodsItem.page++,d.goods.length<e.diydata.goodsItem.psize&&(e.diydata.goodsItem.loaded=!0,d.goods.length||(e.diydata.goodsItem.empty=1)),e.diydata.goodsAll[e.diydata.categorySelectedIndex]||(e.diydata.goodsAll[e.diydata.categorySelectedIndex]=[]),e.diydata.goodsAll[e.diydata.categorySelectedIndex][e.diydata.childSelectedIndex]=e.diydata.goodsItem})},onOrderby:function(e){var t=e.type,d=e.value;this.diydata.goodsItem={page:1,psize:30,empty:0,data:[],orderby:{type:t,value:d}},this.diydata.goodsAll[this.diydata.categorySelectedIndex][this.diydata.childSelectedIndex]=this.diydata.goodsItem,this.onGetGoods()}}),watch:{icart:function(){var e=this.icart.data,t=this.diydata.categoryAll;if(e)for(var d in t)if(t[d].total=0,t[d].child&&t[d].child.length>0)for(var a in t[d].child){t[d].child[a].total=0;var i=0,o=0;for(var s in e)for(var c in e[s])e[s][c].cid==t[d].id&&(o+=e[s][c].num,t[d].total=o,e[s][c].child_id==t[d].child[a].id&&(i+=e[s][c].num,t[d].child[a].total=i))}else{o=0;for(var s in e)for(var c in e[s])e[s][c].cid==t[d].id&&(o+=e[s][c].num,t[d].total=o)}else for(var d in t)if(t[d].total=0,t[d].child)for(var a in t[d].child)t[d].child[a].total=0;this.diydata.categoryAll=t},$route:function(e,t){this.onLoad()}},created:function(){this.query=this.util.parseQuery(this.$route.query),this.sid=this.query.sid,this.cid=this.query.cid},mounted:function(){var e=this;this.onLoad(),setTimeout(function(){var t=document.documentElement.clientHeight;e.diydata.vanColHeight=t,document.getElementById("public-header")&&(e.diydata.vanColHeight=e.diydata.vanColHeight-46),document.getElementById("public-footer")&&(e.diydata.vanColHeight=e.diydata.vanColHeight-50)},50)}},n={render:function(){var e=this,t=e.$createElement,d=e._self._c||t;return d("div",{attrs:{id:"shop-category"}},[d("public-header",{attrs:{title:e.title}}),e._v(" "),d("public-footer",{attrs:{preLoading:e.showPreLoading,menufooter:e.menufooter}}),e._v(" "),d("div",{staticClass:"container",class:{"has-child-0":2==e.diydata.diy.storebasic_style,"has-child-4":2==e.diydata.diy.storebasic_style&&e.diydata.categorySelected&&e.diydata.categorySelected.child&&e.diydata.categorySelected.child.length>0&&e.diydata.categorySelected.child.length<=4,"has-child-8":2==e.diydata.diy.storebasic_style&&e.diydata.categorySelected&&e.diydata.categorySelected.child&&e.diydata.categorySelected.child.length>4},style:e.styleContent},[d("diy",{attrs:{diydata:e.diydata,active:e.active,is_grant:e.is_grant,preLoading:e.showPreLoading},on:{onToggleCategory:e.onToggleCategory,onOrderby:e.onOrderby,onGetGoods:e.onGetGoods}})],1)],1)},staticRenderFns:[]};var h=d("VU/8")(g,n,!1,function(e){d("TqM7")},null,null);t.default=h.exports}});
//# sourceMappingURL=101.3f839661d84a344fc206.js.map