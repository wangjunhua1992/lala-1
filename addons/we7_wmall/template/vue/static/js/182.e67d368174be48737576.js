webpackJsonp([182],{"+kDF":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s("Gu7T"),i=s.n(o),a=s("woOf"),r=s.n(a),l=s("Cz8s"),n=s("+TmT"),c={components:{PublicHeader:l.a,Uploader:n.a},data:function(){return{id:Number,delivery_service:0,goods_quality:0,note:"",goods:[],thumbs:[],newGoods:[],order:{},showPreLoading:!0}},methods:{onLoad:function(){var t=this;this.$route.query.id?this.id=this.$route.query.id:this.$toast("订单不存在或已删除！"),this.util.request({url:"wmall/order/comment/index",data:{id:this.id}}).then(function(e){t.showPreLoading=!1;var s=e.data.message;s.errno?t.$toast(s.message):(console.log(s),t.order=r()(t.order,s.message.order),s.message.goods&&(t.goods=[].concat(i()(t.goods),i()(s.message.goods))),t.goods.forEach(function(e,s){var o={id:e.id,goods_id:e.goods_id,activity:e.activity};t.newGoods.push(o)}))}),this.util.isGlala()&&(this.util.requestPermission({perm:"camera"}),this.util.requestPermission({perm:"photos"}))},favorOppose:function(t,e){t=t;"favor"==(e=e)?(this.goods[t].activity=1,this.newGoods[t].activity=1):(this.goods[t].activity=2,this.newGoods[t].activity=2)},onGetImgsUrl:function(t){this.thumbs=t},onSubmit:function(){var t=this;if(1==this.order.order_type&&!this.delivery_service)return this.$toast("请您评价配送服务"),!1;if(!this.goods_quality)return this.$toast("请您评价商品质量"),!1;var e={id:this.id,note:this.note,goods_quality:this.goods_quality,deliverScore:this.delivery_service,thumbs:this.thumbs,goods:this.newGoods};this.util.request({url:"wmall/order/comment/post",method:"post",data:e}).then(function(e){var s=e.data.message;if(s.errno)return t.util.$toast(s.message),!1;t.util.$toast(s.message,t.util.getUrl({path:"/pages/order/detail",query:{id:t.id}}))})}},mounted:function(){this.onLoad()}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"order-comment"}},[s("public-header",{attrs:{title:"添加评论"}}),t._v(" "),s("div",{staticClass:"content"},[1==t.order.order_type?[s("div",{staticClass:"content-block-title"},[t._v("配送评价")]),t._v(" "),s("van-cell-group",[s("van-cell",[s("div",{staticClass:"flex",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"van-cell-text"},[t._v("配送服务")]),t._v(" "),s("van-rate",{staticClass:"flex",attrs:{size:20,count:5,color:"#ff2d4b","void-color":"#FF6C81"},model:{value:t.delivery_service,callback:function(e){t.delivery_service=e},expression:"delivery_service"}})],1)])],1)]:t._e(),t._v(" "),s("div",{staticClass:"content-block-title"},[t._v("商品评价")]),t._v(" "),s("van-cell-group",[s("van-cell",[s("div",{staticClass:"flex",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"van-cell-text"},[t._v("商品质量")]),t._v(" "),s("van-rate",{staticClass:"flex",attrs:{size:20,count:5,color:"#ff2d4b","void-color":"#FF6C81"},model:{value:t.goods_quality,callback:function(e){t.goods_quality=e},expression:"goods_quality"}})],1)]),t._v(" "),t._l(t.goods,function(e,o){return s("van-cell",{key:o,attrs:{title:e.goods_title}},[s("div",{staticClass:"favor-oppose",attrs:{slot:"right-icon"},slot:"right-icon"},[s("label",{on:{click:function(e){return t.favorOppose(o,"favor")}}},[s("input",{staticClass:"radio",attrs:{type:"radio",value:"1"},domProps:{checked:1==e.activity}}),t._v(" "),s("span",{staticClass:"favor"})]),t._v(" "),s("label",{on:{click:function(e){return t.favorOppose(o,"oppose")}}},[s("input",{staticClass:"radio",attrs:{type:"radio",value:"2"},domProps:{checked:2==e.activity}}),t._v(" "),s("span",{staticClass:"oppose"})])])])})],2),t._v(" "),s("div",{staticClass:"content-block-title"},[t._v("写点什么")]),t._v(" "),s("van-cell-group",[s("van-field",{attrs:{type:"textarea",placeholder:"至少输入10个字，您的建议很重要，来点评一下吧"},model:{value:t.note,callback:function(e){t.note=e},expression:"note"}})],1),t._v(" "),s("div",{staticClass:"content-block-title"},[t._v("有图有真相")]),t._v(" "),s("uploader",{attrs:{max:6},on:{onGetUrl:t.onGetImgsUrl}}),t._v(" "),s("div",{staticClass:"save-btn"},[s("van-button",{attrs:{size:"large"},on:{click:function(e){return t.onSubmit()}}},[t._v("提交评论")])],1)],2),t._v(" "),t.showPreLoading?s("iloading"):t._e()],1)},staticRenderFns:[]};var v=s("VU/8")(c,d,!1,function(t){s("0Icl")},null,null);e.default=v.exports},"0Icl":function(t,e){}});
//# sourceMappingURL=182.e67d368174be48737576.js.map