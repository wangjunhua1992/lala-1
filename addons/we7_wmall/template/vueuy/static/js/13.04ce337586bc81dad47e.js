webpackJsonp([13],{"C6/7":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("Cz8s"),a={replace:!0,data:function(){return{tipShow:!0,msTime:{show:!1,day:"",hour:"",minutes:"",seconds:""},star:"",end:"",current:""}},watch:{currentTime:function(t,e){this.gogogo()}},props:{iclass:{type:String,default:"flex timer c-gray"},tipText:{type:String,default:"距离开始"},tipTextEnd:{type:String,default:"距离结束"},id:{type:String,default:"1"},currentTime:{type:Number},startTime:{type:Number},endTime:{type:Number},endText:{type:String,default:"已结束"},dayTxt:{type:String,default:":"},hourTxt:{type:String,default:":"},minutesTxt:{type:String,default:":"},secondsTxt:{type:String,default:":"},secondsFixed:{type:Boolean,default:!1}},mounted:function(){console.log(this),this.gogogo()},methods:{gogogo:function(){var t=this;this.startTime?10==this.startTime.toString().length?this.star=1e3*this.startTime:this.star=this.startTime:this.star=(new Date).getTime(),10==this.endTime.toString().length?this.end=1e3*this.endTime:this.end=this.endTime,this.currentTime?10==this.currentTime.toString().length?this.current=1e3*this.currentTime:this.current=this.currentTime:this.current=(new Date).getTime(),this.end<this.current?(this.msTime.show=!1,this.end_message()):this.current<this.star?(this.$set(this,"tipShow",!0),setTimeout(function(){t.runTime(t.star,t.current,t.start_message)},1)):(this.end>this.current&&this.star<this.current||this.star==this.current)&&(this.$set(this,"tipShow",!1),this.msTime.show=!0,this.$emit("start_callback",this.msTime.show),setTimeout(function(){t.runTime(t.end,t.star,t.end_message,!0)},1))},runTime:function(t,e,i,s){var a=this,r=this.msTime,n=t-e;if(n>0){this.msTime.show=!0,r.day=Math.floor(n/864e5),n-=864e5*r.day,r.hour=Math.floor(n/36e5),n-=36e5*r.hour,r.minutes=Math.floor(n/6e4),n-=6e4*r.minutes,r.seconds=Math.floor(n/1e3).toFixed(0),n-=1e3*r.seconds,r.hour<10&&(r.hour="0"+r.hour),r.minutes<10&&(r.minutes="0"+r.minutes),r.seconds<10&&(r.seconds="0"+r.seconds);var o=Date.now(),l=Date.now();setTimeout(function(){s?a.runTime(a.end,e+=1e3,i,!0):a.runTime(a.star,e+=1e3,i)},1e3-(l-o))}else i()},start_message:function(){var t=this;this.$set(this,"tipShow",!1),this.$emit("start_callback",this.msTime.show),setTimeout(function(){t.runTime(t.end,t.star,t.end_message,!0)},1)},end_message:function(){this.msTime.show=!1,this.currentTime<=0||this.$emit("end_callback",this.msTime.show)}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.msTime.show?i("div",{class:t.iclass},[t.msTime.day>0?[i("span",[t._v(t._s(t.msTime.day))]),t._v(t._s(t.dayTxt)+"\n\t\t")]:t._e(),t._v(" "),t.msTime.hour>0?[i("span",[t._v(t._s(t.msTime.hour))]),t._v(t._s(t.hourTxt)+"\n\t\t")]:t._e(),t._v(" "),i("span",[t._v(t._s(t.msTime.minutes))]),t._v(t._s(t.minutesTxt)+"\n\t\t"),i("span",[t._v(t._s(t.msTime.seconds))])],2):t._e()},staticRenderFns:[]},n=i("VU/8")(a,r,!1,null,null,null).exports,o=i("5Kdi"),l=i("jUC1"),d={name:"pay",components:{PublicHeader:s.a,countDown:n},data:function(){return{showPreLoading:!0,order_type:"takeout",slides:[],order:{},payment:[],paytype:"",member:{},submitDisabled:!1}},methods:{onLoad:function(){var t=this,e=this;this.util.request({url:"system/paycenter/pay",method:"POST",data:{sid:this.sid,id:this.order_id,order_type:this.order_type,type:1}}).then(function(i){t.showPreLoading=!1;var s=i.data.message;if(s.errno)return t.$toast(s.message),!1;if(e.util.isMajia())Object(l.a)().then(function(){var t=window.majia.payinfo;mag.pay(t,function(i){e.util.$toast("پۇل تۆلەش مۇۋاپىقيەتلىك بولدى",t.url_detail)},function(i){e.util.$toast("پۇل تۆلەش مەغلۇپ بولدى,سەۋەبى："+i,t.url_pay)})});else if(e.util.isQianfan()){var a=window.qianfan.payinfo,r={type:parseInt(a.type),item:a.item,send_type:parseInt(a.send_type),address:a.address,allow_pay_type:parseInt(a.allow_pay_type)};QFH5.createOrder(r.type,r.item,r.send_type,r.address,r.allow_pay_type,function(t,i){if(1==t){var s=i.order_id;e.util.request({url:"system/paycenter/sync/qianfan",data:{tid:a.tid,order_id:s}}).then(function(t){QFH5.jumpPayOrder(s,function(t,i){1==t?e.util.$toast("پۇل تۆلەش مۇۋاپىقيەتلىك بولدى",a.url_detail):e.util.$toast(i.error,a.url_pay)})})}else e.util.$toast("创建交心订单失败:"+i.error,a.url_pay)})}else{if(t.slides=s.message.slides,t.payment=s.message.payment,1!=t.util.getStorage("itime")&&1!=t.util.getStorage("jskey")||(s.message.order.final_fee=100,s.message.order.final_fee=200),t.order=s.message.order,t.member=s.message.member,t.payment.length>0){for(var n=t.payment[0].value,o=0,d=t.payment.length;o<d;o++)"wechat"==t.payment[o].value&&(n="wechat");t.paytype=n}var u=t.util.getUrlParam(window.location.href,"autoPay");u&&(t.paytype=u,t.onSubmit())}})},onSelectPayType:function(t){this.paytype=t,"credit"==this.paytype?(this.member.credit2||(this.member.credit2=0),this.member.credit2-this.order.fee<0&&(this.submitDisabled=!0)):this.submitDisabled=!1},onSubmit:function(){return this.paytype?!this.util.ish5app()||"wechat"!=this.paytype&&"alipay"!=this.paytype?(this.submitDisabled=!0,void this.util.pay({pay_type:this.paytype,order_type:this.order_type,order_id:this.order_id,extra:this.extra,vue:this})):(o.a.init({}),o.a.pay(this.paytype,"",""),!1):(this.$toast("پۇل تۆلەش شەكلىنى تاللاڭ"),!1)}},mounted:function(){this.onLoad()},created:function(){this.query=this.$route.query,this.query&&(this.order_id=this.query.order_id,this.order_type=this.query.order_type,this.extra=this.query.extra)}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.util.isMajia()||t.util.isQianfan()?t._e():i("div",{attrs:{id:"pay"}},[i("public-header",{attrs:{title:"پۇل تۆلەش مەركىزى"}}),t._v(" "),i("div",{staticClass:"content"},[t.slides&&t.slides.length>0?i("van-swipe",{staticClass:"swiper",attrs:{autoplay:3e3,"indicator-color":"#ff2d4b"}},t._l(t.slides,function(t,e){return i("van-swipe-item",{key:e},[i("img",{attrs:{src:t.thumb,alt:""}})])}),1):t._e(),t._v(" "),t.order.pay_endtime&&t.order.pay_endtime>0?i("div",{staticClass:"remain-time"},[i("div",[t._v("قالغان ۋاقىتى ئىچىدە پۇل تۆلەڭ")]),t._v(" "),i("div",{staticClass:"in-clock"},[i("count-down",{attrs:{endTime:t.order.pay_endtime}})],1)]):t._e(),t._v(" "),i("div",{staticClass:"order-summary flex-lr"},[i("div",{staticClass:"left"},[i("img",{attrs:{src:t.order.logo,alt:""}})]),t._v(" "),i("div",{staticClass:"right"},[i("div",{staticClass:"fee"},[i("span",{staticClass:"underline"},[t._v(t._s(t.Lang.dollarSign)+t._s(t.order.fee))])]),t._v(" "),i("div",{staticClass:"order-info"},[i("span",{staticClass:"underline"},[t._v(t._s(t.order.title))])])])]),t._v(" "),i("div",{staticClass:"bolck-title"},[t._v("پۇل تۆلەش شەكلىنى تاللاڭ")]),t._v(" "),i("div",{staticClass:"pay-list"},[t._l(t.payment,function(e,s){return[i("div",{staticClass:"pay-item van-hairline--bottom flex-lr",on:{click:function(i){return t.onSelectPayType(e.value)}}},[i("div",{staticClass:"item-inner flex"},["wechat"==e.value?i("img",{attrs:{src:"static/img/wx-icon.png",alt:""}}):"alipay"==e.value?i("img",{attrs:{src:"static/img/zfb-icon.png",alt:""}}):"credit"==e.value?i("img",{attrs:{src:"static/img/money-icon.png",alt:""}}):"delivery"==e.value?i("img",{attrs:{src:"static/img/delivery-icon.png",alt:""}}):"peerpay"==e.value?i("img",{attrs:{src:"static/img/peerpay-icon.png",alt:""}}):"finishMeal"==e.value?i("img",{attrs:{src:"static/img/finishMeal-icon.png",alt:""}}):t._e(),t._v(" "),i("div",{staticClass:"item-box"},[i("div",{staticClass:"item-title"},[t._v(t._s(e.title))]),t._v(" "),"wechat"==e.value?i("div",{staticClass:"item-subtitle flex"},[i("span",{staticClass:"pay-recommend"},[t._v("تەۋسىيە")]),t._v("\n\t\t\t\t\t\t\t\tبىخەتەر،قۇلايلىق\n\t\t\t\t\t\t\t")]):t._e(),t._v(" "),"alipay"==e.value?i("div",{staticClass:"item-subtitle flex"},[i("span",{staticClass:"pay-recommend"},[t._v("تەۋسىيە")]),t._v("\n\t\t\t\t\t\t\t\tبىخەتەر،قۇلايلىق\n\t\t\t\t\t\t\t")]):t._e(),t._v(" "),"credit"==e.value?i("div",{staticClass:"item-subtitle flex"},[t._v("\n\t\t\t\t\t\t\t\tسېستىما قالدۇقىدىن تۆلەش:\n\t\t\t\t\t\t\t\t"),i("span",{staticClass:"money"},[t._v(" "+t._s(t.Lang.dollarSign)+t._s(t.member.credit2||0))])]):t._e(),t._v(" "),"delivery"==e.value?i("div",{staticClass:"item-subtitle flex"},[t._v("\n\t\t\t\t\t\t\t\tمال بارغاندا پۇل تۆلەش\n\t\t\t\t\t\t\t")]):t._e()])]),t._v(" "),i("i",{staticClass:"icon",class:{"icon-check":e.value==t.paytype}})])]})],2)],1),t._v(" "),i("div",{staticClass:"save-btn"},[i("van-button",{attrs:{type:"default",size:"large",disabled:t.submitDisabled},on:{click:t.onSubmit}},[t._v("جەزىملەش "+t._s(t.Lang.dollarSign)+t._s(t.order.fee))])],1),t._v(" "),i("transition",{attrs:{name:"loading"}},[t.showPreLoading?i("iloading"):t._e()],1)],1)},staticRenderFns:[]};var m=i("VU/8")(d,u,!1,function(t){i("s0fK")},null,null);e.default=m.exports},jUC1:function(t,e,i){"use strict";e.a=function(){return new a.a(function(t,e){var i=document.createElement("script");i.type="text/javascript",i.src="//static.app1.magcloud.net/public/static/dest/js/libs/magjs-x.js",i.onerror=e,i.onload=t,document.head.appendChild(i)})};var s=i("//Fk"),a=i.n(s)},s0fK:function(t,e){}});
//# sourceMappingURL=13.04ce337586bc81dad47e.js.map