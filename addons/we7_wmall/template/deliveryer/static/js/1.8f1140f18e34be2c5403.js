webpackJsonp([1],{"2NjV":function(e,t,a){"use strict";a.d(t,"a",function(){return d});var r=a("Gu7T"),i=a.n(r),s=a("woOf"),o=a.n(s),n=a("YaEn");function d(e){var t=e.type;if("delivery_transfer"!=t&&"direct_transfer"!=t&&"cancel"!=t){var a=function(e){return{delivery_assign:{tip:"确定抢单吗",success_status:2},direct_transfer_refuse:{tip:"确定拒绝转单吗",success_status:3,reply:"refuse"},direct_transfer_agree:{tip:"确定接受转单吗",success_status:2,reply:"agree"},delivery_instore:{tip:"确定已取货吗",success_status:3},delivery_success:{tip:"确认已送达吗",success_status:4},wx_notice:{tip:"确定通知下单人你已到达送餐地址吗",success_status:0}}[e]}(t),r=a.success_status;"direct_transfer_refuse"!=t&&"direct_transfer_agree"!=t||(t="direct_transfer_reply");var s="delivery/order/errander/status";"wx_notice"==t&&(s="delivery/order/errander/notice");var d={url:s,data:{id:e.order.id,type:t,reply:a.reply||"",code:e.code,_deliveryerOrderTabType:"errander"},confirm:e.code?"":a.tip,success:function(s){if(e.vue.util.$toast(s),"wx_notice"!=t){if("detail"==e.from)"direct_transfer_reply"==t?(e.vue.order.transfer_delivery_status=r,"agree"==a.reply&&(e.vue.order.deliveryer_id=e.vue.order.transfer_deliveryer_id)):e.vue.order.delivery_status=r,e.vue.order=o()({},e.vue.order);else{if("agree"==a.reply)e.vue.records.data[e.index].transfer_delivery_status=r;else if("refuse"==a.reply)e.vue.records.data.splice(e.index,1);else{-1!=["delivery_assign","delivery_instore","delivery_success"].indexOf(t)&&e.vue.records.data.splice(e.index,1)}var n=e.vue.util.getStorage("orderTabs");n&&n.length>0&&(e.vue.tabs=[].concat(i()(n)))}e.code&&(e.vue.code=o()({},{codeShow:!1,value:"",orderIndex:-1}))}},fail:function(t){e.vue.util.$toast(t.message),e.code&&(e.vue.code=o()({},{codeShow:!1,value:"",orderIndex:-1}))}};e.vue.util.jspost(d)}else n.a.push(e.vue.util.getUrl({path:"/pages/paotui/op",query:{order_id:e.order.id,type:t,order_status:e.order.status}}))}},"8jHR":function(e,t){},LN1q:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Cz8s"),i=a("75NE"),s=a("deIj"),o=a("2NjV"),n=a("Yo4o"),d=a("nIsk"),l={components:{publicHeader:r.a,countDown:i.a},data:function(){return{showPreLoading:!0,order:{data:{order:{partData:[]}}},deliveryer:{},verification_code:0,code:{codeShow:!1,value:""},config:{map:{location_x:"",location_y:""}},yinsihao:{status:!1,secret_mobile:"",extension:""},MapType:this.util.getStorage("MapType")||"gaode"}},methods:{onLoad:function(){var e=this;Object(s.a)({vue:e,url:"delivery/order/errander/detail",data:{id:e.id},success:function(t){e.order=e.util.extend(e.order,t.order),e.deliveryer=t.deliveryer,e.config=t.config,e.verification_code=t.verification_code,e.onLoadMap()}})},onChangeOrderStatus:function(e){("delivery_success"!=e||1!=this.verification_code||(this.code.codeShow=!0,this.code.value))&&Object(o.a)({vue:this,type:e,from:"detail",order:this.order,code:this.code.value})},onLoadMap:function(){var e=this;if("gaode"==e.MapType)Object(n.a)().then(function(t){e.map=new t.Map("map-container",{resizeEnable:!0,center:[e.config.map.location_y,e.config.map.location_x],zoom:13}),t.plugin("AMap.Driving",function(){var a=new t.Driving({policy:t.DrivingPolicy.LEAST_TIME,map:e.map,hideMarkers:!0}),r={},i=[],s=[e.deliveryer.location_y,e.deliveryer.location_x],o=[e.order.accept_location_y,e.order.accept_location_x];if(r=new t.Marker({position:s,offset:new t.Pixel(-13,-31),content:'<div class="marker-start-route"></div>'}),i.push(r),r=new t.Marker({position:o,offset:new t.Pixel(-13,-31),content:'<div class="marker-end-route"></div>'}),i.push(r),e.order.buy_location_y&&e.order.buy_location_x){var n=[e.order.buy_location_y,e.order.buy_location_x];r=new t.Marker({position:n,offset:new t.Pixel(-13,-31),content:'<div class="marker-pass-route"></div>'}),i.push(r)}a.search(s,o,{waypoints:[n]},function(e,t){"complete"===e?console.log("绘制驾车路线完成"):console.log("获取驾车数据失败："+t)}),e.map.add(i),e.map.setFitView()})});else if("google"==e.MapType){var t=parseFloat(e.config.map.location_x),a=parseFloat(e.config.map.location_y);Object(d.a)().then(function(r){window.map=e.map=new r.maps.Map(document.getElementById("map-container"),{center:{lat:t,lng:a},zoom:13,disableDefaultUI:!0});var i={lat:parseFloat(e.deliveryer.location_x),lng:parseFloat(e.deliveryer.location_y)},s={lat:parseFloat(e.order.accept_location_x),lng:parseFloat(e.order.accept_location_y)},o=[],n={};e.order.buy_location_y&&e.order.buy_location_x&&(n={lat:parseFloat(e.order.buy_location_x),lng:parseFloat(e.order.buy_location_y)},o.push({location:n,stopover:!0}));var d=new r.maps.DirectionsService,l=new r.maps.DirectionsRenderer({suppressMarkers:!0});(d.route({origin:i,destination:s,travelMode:"DRIVING",waypoints:o,avoidFerries:!0,avoidHighways:!0,avoidTolls:!0,optimizeWaypoints:!0},function(e,t){"OK"==t&&(l.setDirections(e),l.setMap(map))}),new r.maps.Marker({position:i,map:map,icon:{url:"../../../static/img/start.png",scaledSize:new r.maps.Size(26,31)}}).setMap(map),new r.maps.Marker({position:s,map:map,icon:{url:"../../../static/img/end.png",scaledSize:new r.maps.Size(26,31)}}).setMap(map),n.lat&&n.lng)&&new r.maps.Marker({position:n,map:map,icon:{url:"../../../static/img/ds.png",scaledSize:new r.maps.Size(26,31)}}).setMap(map)})}},onSetMapZoom:function(){var e=this.map.getZoom();e++,this.map.setZoomAndCenter(e)},onCallCustomer:function(e){var t=this;e=e||"accept",Object(s.a)({vue:t,url:"yinsihao/yinsihao",data:{order_id:t.order.id,type:"errander",ordersn:t.order.order_sn,orderType:"errander",memberType:e},success:function(e){t.yinsihao.secret_mobile=e.data.secret_mobile,t.yinsihao.extension=e.data.extension,t.yinsihao.status=!0}})}},created:function(){this.query=this.$route.query,this.query&&this.query.id&&(this.id=this.query.id)},mounted:function(){this.onLoad()}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"paotui-detail"}},[a("public-header",{attrs:{title:"跑腿订单详情"}}),e._v(" "),a("div",{staticClass:"content font-14"},[a("div",{attrs:{id:"map-container"}}),e._v(" "),a("div",{staticClass:"tip"},[e._v("跑腿订单配送")]),e._v(" "),a("div",{staticClass:"bg-default"},[a("div",{staticClass:"flex-lr padding-10-lr padding-15-tb van-hairline--bottom"},[a("div",{staticClass:"c-primary font-500"},[e._v("#"+e._s(e.order.id))]),e._v(" "),2==e.order.status?a("div",{staticClass:"c-danger flex"},[e.order.delivery_overtime>0?[e._v("\n\t\t\t\t\t\t距超时"),a("count-down",{staticClass:"c-danger",attrs:{endTime:e.order.delivery_overtime}})]:e.order.delivery_overtime_start>0?[e._v("\n\t\t\t\t\t\t已超时"),a("count-down",{staticClass:"c-danger",attrs:{startTime:e.order.delivery_overtime_start}})]:e._e()],2):e._e()]),e._v(" "),a("div",{staticClass:"flex padding-10-lr padding-15-tb van-hairline--bottom"},[a("span",{staticClass:"handle-type"},[e._v(e._s(e.order.delivery_collect_type_cn))]),e._v(" "),a("span",{staticClass:"delivery-time"},[e._v("配送 "+e._s(e.order.delivery_time))])]),e._v(" "),a("ul",{staticClass:"address padding-10-lr",attrs:{"margin-15-t":""}},[a("li",{staticClass:"flex-lr margin-15-t"},[a("ul",{staticClass:"address-text buy-text"},[a("li",{staticClass:"font-15 font-500"},[e._v(e._s(e.order.buy_address))]),e._v(" "),e.order.buy_username?a("li",{staticClass:"c-gray margin-5-t font-13"},[e._v(e._s(e.order.buy_username)+" "+e._s(e.order.buy_mobile))]):e._e()]),e._v(" "),e.order.buy_location_x&&e.order.buy_location_y?a("i",{staticClass:"icon icon-locationfill",on:{click:function(t){e.util.jsLocation({lat:e.order.buy_location_x,lng:e.order.buy_location_y,address:e.order.buy_address,type:"app"})}}}):e._e()]),e._v(" "),a("li",{staticClass:"flex-lr margin-15-t"},[a("ul",{staticClass:"address-text accept-text"},[a("li",{staticClass:"font-15 font-500 "},[e._v(e._s(e.order.accept_address))]),e._v(" "),a("li",{staticClass:"c-gray margin-5-t font-13"},[e._v(e._s(e.order.accept_username)+" "+e._s(e.order.accept_mobile))])]),e._v(" "),e.order.accept_location_x&&e.order.accept_location_y?a("i",{staticClass:"icon icon-locationfill",on:{click:function(t){e.util.jsLocation({lat:e.order.accept_location_x,lng:e.order.accept_location_y,address:e.order.accept_address,type:"app"})}}}):e._e()])]),e._v(" "),a("div",{staticClass:"tel-group padding-10-lr padding-15-tb van-hairline--top margin-15-t flex-lr"},[e.order.buy_mobile?[e.order.data&&1==e.order.data.yinsihao_status?a("div",{staticClass:"tel-item flex van-hairline--right",on:{click:function(t){e.onCallCustomer("buy")}}},[e._m(0),e._v(" "),a("span",[e._v(e._s(e.order.buy_mobile))])]):a("div",{staticClass:"tel-item flex van-hairline--right",on:{click:function(t){e.util.jsTel(e.order.buy_mobile)}}},[e._m(1),e._v(" "),a("span",[e._v(e._s(e.order.buy_mobile))])])]:e._e(),e._v(" "),e.order.data&&1==e.order.data.yinsihao_status?a("div",{staticClass:"tel-item flex",on:{click:function(t){e.onCallCustomer("accept")}}},[e._m(2),e._v(" "),a("span",[e._v(e._s(e.order.accept_mobile))])]):a("div",{staticClass:"tel-item flex",on:{click:function(t){e.util.jsTel(e.order.accept_mobile)}}},[e._m(3),e._v(" "),a("span",[e._v(e._s(e.order.accept_mobile))])])],2)]),e._v(" "),a("div",{staticClass:"tip"},[e._v("货品信息")]),e._v(" "),a("div",{staticClass:"goods-info bg-default"},[e.order.note?a("div",{staticClass:"note"},[a("div",{staticClass:"note-title"},[e._v("备注:")]),e._v(" "),a("div",{staticClass:"note-text"},[e._v(e._s(e.order.note))])]):e._e(),e._v(" "),a("div",{staticClass:"padding-15-b padding-5-t padding-10-lr van-hairline--bottom"},[a("ul",{staticClass:"margin-10-t c-gray flex-lr"},[a("li",[e._v("物品名称")]),e._v(" "),a("li",[e._v(e._s(e.order.goods_name))])]),e._v(" "),e.order.box_price>0?a("ul",{staticClass:"margin-10-t c-gray flex-lr"},[a("li",[e._v("物品预期价格")]),e._v(" "),a("li",[e._v(e._s(e.Lang.dollarSign)+e._s(e.order.goods_price))])]):e._e(),e._v(" "),e.order.goods_weight>0?a("ul",{staticClass:"margin-10-t c-gray flex-lr"},[a("li",[e._v("物品重量")]),e._v(" "),a("li",[e._v(e._s(e.order.goods_weight)+"公斤")])]):e._e(),e._v(" "),e.order.data&&e.order.data.order&&e.order.data.order.partData&&e.order.data.order.partData.length>0?e._l(e.order.data.order.partData,function(t,r){return a("ul",{staticClass:"margin-10-t c-gray flex-lr"},["multipleChoices"!=t.type?[a("li",[e._v(e._s(t.title))]),e._v(" "),a("li",[e._v(e._s(t.value))])]:[a("li",[e._v(e._s(t.title))]),e._v(" "),a("li",[e._l(t.value,function(t){return[e._v("\n\t\t\t\t\t\t\t\t\t"+e._s(" "+t)+"\n\t\t\t\t\t\t\t\t")]})],2)]],2)}):e._e()],2),e._v(" "),1==e.order.is_pay?a("div",["delivery"!=e.order.pay_type?a("div",{staticClass:"have-pay"}):"delivery"==e.order.pay_type?a("div",{staticClass:"delivery-pay"}):e._e()]):e._e()]),e._v(" "),e.order.thumbs&&e.order.thumbs.length>0?[a("div",{staticClass:"tip"},[e._v("顾客上传的图片")]),e._v(" "),a("div",{staticClass:"goods-imgs padding-10-lr padding-15-t padding-5-b bg-default"},[a("van-row",{attrs:{gutter:"10"}},e._l(e.order.thumbs,function(t,r){return a("van-col",{key:r,attrs:{span:"6"}},[a("div",{staticClass:"img-wrap",on:{click:function(t){e.util.jsPreviewImage(e.order.thumbs,r)}}},[a("img",{staticClass:"wh-100",attrs:{src:t,alt:""}})])])}))],1)]:e._e(),e._v(" "),e.order.data&&e.order.data.order&&e.order.data.order.thumbs&&e.order.data.order.thumbs.length>0?[e._l(e.order.data.order.thumbs,function(t){return[a("div",{staticClass:"tip"},[e._v(e._s(t.title))]),e._v(" "),a("div",{staticClass:"goods-imgs padding-10-lr padding-15-t padding-5-b bg-default"},[a("van-row",{attrs:{gutter:"10"}},e._l(t.value,function(r,i){return a("van-col",{key:i,attrs:{span:"6"}},[a("div",{staticClass:"img-wrap",on:{click:function(a){e.util.jsPreviewImage(t.value,i)}}},[a("img",{staticClass:"wh-100",attrs:{src:r,alt:""}})])])}))],1)]})]:e._e(),e._v(" "),e.order.data&&e.order.data.order&&e.order.data.order.extra_fee&&e.order.data.order.extra_fee.length>0?[a("div",{staticClass:"tip"},[e._v("附加服务")]),e._v(" "),a("div",{staticClass:"bg-default padding-10-lr padding-5-t padding-15-b"},e._l(e.order.data.order.extra_fee,function(t,r){return a("ul",{key:r,staticClass:"margin-10-t flex-lr"},[a("li",[e._v(e._s(t.title))]),e._v(" "),a("li",[e._l(t.value,function(t){return[e._v("\n\t\t\t\t\t\t\t"+e._s(" "+t.name)+"\n\t\t\t\t\t\t")]})],2)])}))]:e._e(),e._v(" "),a("div",{staticClass:"tip"},[e._v("订单信息")]),e._v(" "),a("div",{staticClass:"bg-default padding-10-lr padding-5-t padding-15-b"},[a("ul",{staticClass:"margin-10-t flex-lr"},[a("li",[e._v("订单编号")]),e._v(" "),a("li",[e._v(e._s(e.order.order_sn))])]),e._v(" "),a("ul",{staticClass:"margin-10-t flex-lr"},[a("li",[e._v("下单时间")]),e._v(" "),a("li",[e._v(e._s(e.order.addtime_cn))])]),e._v(" "),a("ul",{staticClass:"margin-10-t flex-lr"},[a("li",[e._v("付款方式")]),e._v(" "),a("li",[e._v(e._s(e.order.pay_type_cn))])])]),e._v(" "),a("div",{staticClass:"tip"},[e._v("订单收入")]),e._v(" "),a("div",{staticClass:"bg-default padding-10-lr padding-5-t padding-15-b"},[a("ul",{staticClass:"margin-10-t flex-lr"},[a("li",[e._v("配送费")]),e._v(" "),a("li",[e._v(e._s(e.Lang.dollarSign)+e._s(e.order.deliveryer_fee))])]),e._v(" "),e.order.delivery_tips>0?a("ul",{staticClass:"margin-10-t flex-lr"},[a("li",[e._v("小费")]),e._v(" "),a("li",[e._v(e._s(e.Lang.dollarSign)+e._s(e.order.delivery_tips))])]):e._e(),e._v(" "),a("ul",{staticClass:"margin-10-t flex-lr"},[a("li",[e._v("本单收入")]),e._v(" "),a("li",[e._v(e._s(e.Lang.dollarSign)+e._s(e.order.deliveryer_total_fee))])])]),e._v(" "),a("div",{staticClass:"btn-group padding-10-lr padding-15-t padding-5-b"},[a("van-row",{attrs:{gutter:"10"}},[e.order.transfer_deliveryer_id==e.deliveryer.id&&1==e.order.transfer_delivery_status?[a("van-col",{attrs:{span:"8"}},[a("div",{staticClass:"btn-item bg-danger",on:{click:function(t){e.onChangeOrderStatus("direct_transfer_refuse")}}},[e._v("拒绝转单")])]),e._v(" "),a("van-col",{attrs:{span:"8"}},[a("div",{staticClass:"btn-item bg-primary",on:{click:function(t){e.onChangeOrderStatus("direct_transfer_agree")}}},[e._v("接受转单")])])]:e.deliveryer.id==e.order.deliveryer_id?[3==e.order.delivery_status?a("van-col",{attrs:{span:"8"}},[a("div",{staticClass:"btn-item bg-primary",on:{click:function(t){e.onChangeOrderStatus("delivery_success")}}},[e._v("确认送达")])]):e._e(),e._v(" "),2==e.order.delivery_status?a("van-col",{attrs:{span:"8"}},[a("div",{staticClass:"btn-item bg-primary",on:{click:function(t){e.onChangeOrderStatus("delivery_instore")}}},[e._v("确认取货")])]):e._e(),e._v(" "),1==e.order.deliveryer_transfer_status?a("van-col",{attrs:{span:"8"}},[a("div",{staticClass:"btn-item bg-primary",on:{click:function(t){e.onChangeOrderStatus("delivery_transfer")}}},[e._v("申请转单")])]):e._e(),e._v(" "),1==e.order.deliveryer_transfer_status?a("van-col",{attrs:{span:"8"}},[a("div",{staticClass:"btn-item bg-danger",on:{click:function(t){e.onChangeOrderStatus("direct_transfer")}}},[e._v("定向转单")])]):e._e(),e._v(" "),1==e.order.deliveryer_cancel_status?a("van-col",{attrs:{span:"8"}},[a("div",{staticClass:"btn-item bg-danger",on:{click:function(t){e.onChangeOrderStatus("cancel")}}},[e._v("取消订单")])]):e._e()]:e._e()],2)],1)],2),e._v(" "),e.showPreLoading?a("iloading"):e._e(),e._v(" "),a("van-dialog",{attrs:{"show-cancel-button":"",confirmButtonText:"确认送达"},on:{confirm:function(t){e.onChangeOrderStatus("delivery_success")},cancel:function(t){e.code.codeShow=!1}},model:{value:e.code.codeShow,callback:function(t){e.$set(e.code,"codeShow",t)},expression:"code.codeShow"}},[a("van-field",{attrs:{placeholder:"输入收货码","input-align":"center",readonly:""}}),e._v(" "),a("van-field",{attrs:{placeholder:"请输入收货码"},model:{value:e.code.value,callback:function(t){e.$set(e.code,"value",t)},expression:"code.value"}})],1),e._v(" "),a("van-dialog",{attrs:{"show-cancel-button":"",title:"顾客号码保护中","confirm-button-text":"立即联系"},on:{confirm:function(t){e.util.jsTel(e.yinsihao.secret_mobile)}},model:{value:e.yinsihao.status,callback:function(t){e.$set(e.yinsihao,"status",t)},expression:"yinsihao.status"}},[a("div",{staticClass:"padding-15-tb text-center font-16"},[a("span",{staticClass:"font-bold c-default"},[e._v(e._s(e.yinsihao.secret_mobile))]),e._v(" "),a("span",{staticClass:"padding-10-lr"},[e._v("转")]),e._v(" "),a("span",{staticClass:"font-bold c-danger"},[e._v(e._s(e.yinsihao.extension))])]),e._v(" "),a("div",{staticClass:"padding-15-b font-14 c-gray text-center"},[e._v("播打"+e._s(e.yinsihao.secret_mobile)+"接通后，输入"+e._s(e.yinsihao.extension)+"#即可")])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"img-wrap"},[t("img",{staticClass:"w-100",attrs:{src:"static/img/store.png",alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"img-wrap"},[t("img",{staticClass:"w-100",attrs:{src:"static/img/store.png",alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"img-wrap"},[t("img",{staticClass:"w-100",attrs:{src:"static/img/customer.png",alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"img-wrap"},[t("img",{staticClass:"w-100",attrs:{src:"static/img/customer.png",alt:""}})])}]};var _=a("VU/8")(l,c,!1,function(e){a("8jHR")},null,null);t.default=_.exports},nIsk:function(e,t,a){"use strict";t.a=function(){return new i.a(function(e,t){window.initMap=function(){e(google)};var a=document.createElement("script");a.type="text/javascript",a.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyABxMCzgtzJxCbJu8Cxwv7BszayIAWN1xw&callback=initMap",a.async=!0,a.defer=!0,a.onerror=t,document.head.appendChild(a)})};var r=a("//Fk"),i=a.n(r)}});