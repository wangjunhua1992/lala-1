webpackJsonp([15],{wbpO:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("woOf"),a=s.n(i),n=s("Gu7T"),o=s.n(n),l=s("Cz8s"),c=s("deIj"),r={data:function(){return{comments:{page:1,psize:15,loading:!1,finished:!1,empty:!1,data:[]},commentReply:[],showPreLoading:!0,isRefresh:!1,filter:{items:{type:"-1"}},replyPopup:!1,reply:"",replyId:0,replyIndex:0,commentReplySelectedIndex:""}},components:{publicHeader:l.a},methods:{onSelectCommentReply:function(t){this.reply=this.commentReply[t]},onLoad:function(t){var e=this;if(t&&(this.comments={page:1,psize:15,loading:!0,finished:!1,empty:!1,data:[]}),this.comments.finished)return!1;this.util.request({url:"manage/service/comment",data:{page:this.comments.page,psize:this.comments.psize,type:this.filter.items.type}}).then(function(t){e.showPreLoading=!1;var s=t.data.message;if(s.errno)return options.vue.util.$toast(s.message),!1;var i=s.message.comments;e.comments.data=[].concat(o()(e.comments.data),o()(i)),e.comments.data.length||(e.comments.empty=!0),i&&i.length<e.comments.psize&&(e.comments.finished=!0),e.comments.page++,e.comments.loading=!1,e.isRefresh=!1;var a=s.message.store;a&&a.comment_reply&&a.comment_reply.length>0&&(e.commentReply=[].concat(o()(a.comment_reply)))})},onPullDownRefresh:function(){this.onLoad(!0)},onChangeStatus:function(t,e,s){var i=this;i.util.jspost({url:"manage/service/comment/comment_status",data:{id:t.id,status:e},confirm:"确定修改审核状态吗？",success:function(){i.comments.data[s].status=e}})},onToggleStatus:function(t){t=parseInt(t),this.filter.items.type!=t&&(this.filter.items.type=t,this.onLoad(!0))},onToogleReplyPopup:function(t,e){this.replyPopup=!this.replyPopup,t>0&&e>-1&&(this.replyId=t,this.replyIndex=e)},onConfirmReply:function(){var t=this;t.reply?t.replyId>0&&t.replyIndex>-1&&Object(c.c)({vue:t,url:"manage/service/comment/reply",data:{id:t.replyId,reply:t.reply},success:function(e){t.comments.data[t.replyIndex]=a()(t.comments.data[t.replyIndex],e),t.reply="",t.commentReplySelectedIndex="",t.util.$toast("回复成功"),t.onToogleReplyPopup()}}):this.util.$toast("回复内容不能为空")}},mounted:function(){this.onLoad()}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"service-comment"}},[s("public-header",{attrs:{title:"用户评价"}}),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"wrap-search"},[s("div",{staticClass:"tab-group flex-lr border-1px-b"},[s("div",{staticClass:"tab-item",class:{active:-1==t.filter.items.type},on:{click:function(e){t.onToggleStatus(-1)}}},[t._v("全部评价")]),t._v(" "),s("div",{staticClass:"tab-item",class:{active:1==t.filter.items.type},on:{click:function(e){t.onToggleStatus(1)}}},[t._v("好评")]),t._v(" "),s("div",{staticClass:"tab-item",class:{active:2==t.filter.items.type},on:{click:function(e){t.onToggleStatus(2)}}},[t._v("中评")]),t._v(" "),s("div",{staticClass:"tab-item",class:{active:3==t.filter.items.type},on:{click:function(e){t.onToggleStatus(3)}}},[t._v("差评")])])]),t._v(" "),s("van-pull-refresh",{on:{refresh:function(e){t.onPullDownRefresh()}},model:{value:t.isRefresh,callback:function(e){t.isRefresh=e},expression:"isRefresh"}},[t.comments.empty?s("div",{staticClass:"no-data"},[s("img",{attrs:{src:"static/img/order_no_con.png",alt:""}}),t._v(" "),s("p",[t._v("没有符合条件的数据!")])]):s("van-list",{staticClass:"comment-list",attrs:{finished:t.comments.finished,offset:100,"immediate-check":!1},on:{load:t.onLoad},model:{value:t.comments.loading,callback:function(e){t.$set(t.comments,"loading",e)},expression:"comments.loading"}},[t._l(t.comments.data,function(e,i){return s("div",{key:e.id,staticClass:"comment-item"},[s("van-row",[s("van-col",{attrs:{span:"4"}},[s("div",{staticClass:"comment-img"},[s("img",{staticClass:"img-100",attrs:{src:e.avatar,alt:""}})])]),t._v(" "),s("van-col",{attrs:{span:"20"}},[s("div",{staticClass:"comment-right"},[s("div",{staticClass:"comment-title flex-lr"},[s("div",{staticClass:"flex"},[s("div",{staticClass:"comment-number"},[t._v(t._s(e.mobile))]),t._v(" "),s("div",{staticClass:"c-danger font-bold"},[t._v(t._s(e.score)+"星")])]),t._v(" "),s("div",{staticClass:"font-13 c-gray"},[t._v(t._s(e.addtime))])]),t._v(" "),s("div",{staticClass:"padding-10-b flex-lr"},[s("div",{staticClass:"flex"},[s("div",{staticClass:"font-12 c-gray"},[t._v("商品质量")]),t._v(" "),s("van-rate",{attrs:{size:12,count:5,color:"#ffd21e",disabled:!0,"disabled-color":"#ffd21e"},model:{value:e.goods_quality,callback:function(s){t.$set(e,"goods_quality",s)},expression:"item.goods_quality"}})],1),t._v(" "),s("div",{staticClass:"flex"},[s("div",{staticClass:"font-12 c-gray"},[t._v("配送服务")]),t._v(" "),s("van-rate",{attrs:{size:12,count:5,color:"#ffd21e",disabled:!0,"disabled-color":"#ffd21e"},model:{value:e.delivery_service,callback:function(s){t.$set(e,"delivery_service",s)},expression:"item.delivery_service"}})],1)]),t._v(" "),s("div",{staticClass:"flex font-14 c-default padding-10-b"},[t._v(t._s(e.note))]),t._v(" "),e.thumbs?s("div",{staticClass:"goods-img"},t._l(e.thumbs,function(i,a){return s("div",{staticClass:"goods-img-detail",on:{click:function(s){t.util.jsPreviewImage(e.thumbs)}}},[s("img",{staticClass:"img-100",attrs:{src:i,alt:""}})])})):t._e(),t._v(" "),e.reply?s("div",{staticClass:"replay margin-10-b"},[t._v("\n\t\t\t\t\t\t\t\t 商家回复("+t._s(t.util.formatDate(e.replytime,"datetime"))+"): "+t._s(e.reply)+"\n\t\t\t\t\t\t\t")]):t._e(),t._v(" "),s("div",{staticClass:"comment-check"},[1==e.status?s("img",{staticClass:"img-100",attrs:{src:"static/img/pass-check.png",alt:""}}):2==e.status?s("img",{staticClass:"img-100",attrs:{src:"static/img/no-pass-check.png",alt:""}}):0==e.status?s("img",{staticClass:"img-100",attrs:{src:"static/img/wait-check.png",alt:""}}):t._e()])])])],1),t._v(" "),s("div",{staticClass:"border-1px-t btn-group"},[1==e.self_audit_comment?[2!=e.status?s("div",{staticClass:"btn-item bg-danger",on:{click:function(s){t.onChangeStatus(e,2,i)}}},[t._v("审核未通过")]):t._e(),t._v(" "),1!=e.status?s("div",{staticClass:"btn-item bg-info",on:{click:function(s){t.onChangeStatus(e,1,i)}}},[t._v("审核通过")]):t._e()]:t._e(),t._v(" "),s("div",{staticClass:"btn-item bg-info",on:{click:function(s){t.onToogleReplyPopup(e.id,i)}}},[t._v("回复")]),t._v(" "),s("router-link",{staticClass:"btn-item bg-info",attrs:{tag:"div",to:t.util.getUrl({path:"/pages/order/detail",query:{id:e.oid}})}},[t._v("查看订单")])],2)],1)}),t._v(" "),t.comments.finished?s("div",{staticClass:"loaded"},[s("div",{staticClass:"loaded-tips"},[t._v("没有更多了")])]):t._e()],2)],1)],1),t._v(" "),t.showPreLoading?s("iloading"):t._e(),t._v(" "),s("van-popup",{staticClass:"reply-popup",attrs:{position:"bottom"},model:{value:t.replyPopup,callback:function(e){t.replyPopup=e},expression:"replyPopup"}},[s("div",{staticClass:"popup-title van-hairline--bottom"},[s("span",{staticClass:"popup-cancel",on:{click:t.onToogleReplyPopup}},[t._v("取消")]),t._v(" "),s("span",[t._v("评论回复")]),t._v(" "),s("span",{on:{click:t.onConfirmReply}},[t._v("确定")])]),t._v(" "),s("div",{staticClass:"popup-content"},[t.commentReply.length>0?[s("div",{staticClass:"padding-10-tb padding-15-l font-14 c-gray"},[t._v("选择回复")]),t._v(" "),s("van-radio-group",{on:{change:t.onSelectCommentReply},model:{value:t.commentReplySelectedIndex,callback:function(e){t.commentReplySelectedIndex=e},expression:"commentReplySelectedIndex"}},[s("van-cell-group",t._l(t.commentReply,function(e,i){return s("van-cell",{key:i,staticClass:"no-fix",attrs:{clickable:""},on:{click:function(e){t.commentReplySelectedIndex=i}}},[s("div",{staticClass:"ellipsis",attrs:{slot:"title"},slot:"title"},[t._v(t._s(e))]),t._v(" "),s("van-radio",{attrs:{name:i}})],1)}))],1)]:t._e(),t._v(" "),s("div",{staticClass:"padding-10-tb padding-15-l font-14 c-gray"},[t._v("自定义回复")]),t._v(" "),s("van-field",{attrs:{type:"textarea",placeholder:"限300字符，请勿恶意回复，一经查实将严肃处理，回复后不可修改",rows:"8"},model:{value:t.reply,callback:function(e){t.reply=e},expression:"reply"}})],2)])],1)},staticRenderFns:[]};var d=s("VU/8")(r,m,!1,function(t){s("xIH6")},null,null);e.default=d.exports},xIH6:function(t,e){}});
//# sourceMappingURL=15.36a37dcc2cb01d4ac1fb.js.map