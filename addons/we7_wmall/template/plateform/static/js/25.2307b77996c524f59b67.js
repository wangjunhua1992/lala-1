webpackJsonp([25],{dvXU:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=s("Gu7T"),i=s.n(e),n={data:function(){return{chats:{page:1,psize:20,loading:!1,finished:!1,data:[]},showPreLoading:!0}},methods:{onLoad:function(){var t=this;if(t.chats.finished)return!1;t.util.request({url:"plateform/kefu/plateform/index",data:{page:t.chats.page,psize:t.chats.psize}}).then(function(a){t.showPreLoading=!1;var s=a.data.message;if(s.errno)t.util.$toast(s.message);else{var e=(s=s.message).chats.chats;e&&e.length>0?(t.chats.data=[].concat(i()(t.chats.data),i()(e)),e.length<t.chats.psize&&(t.chats.finished=!0)):t.chats.finished=!0,t.chats.page++,t.chats.loading=!1}})},onCloseChat:function(t){var a=this;a.$dialog.confirm({title:"确定从会话列表移除该会话吗",confirmButtonColor:"#4FAE52"}).then(function(){a.util.request({url:"plateform/kefu/plateform/delete",data:{chatid:a.chats.data[t].id}}).then(function(s){var e=s.data.message;e.errno?a.util.$toast(e.message):a.$delete(a.chats.data,t)})}).catch(function(){})}},mounted:function(){},components:{PublicHeader:s("Cz8s").a}},l={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{attrs:{id:"kefu-index"}},[s("public-header",{attrs:{title:"消息中心"}},[s("router-link",{staticClass:"flex",attrs:{slot:"right",tag:"div",to:t.util.getUrl({path:"/pages/plugin/kefu/setting",query:{}})},slot:"right"},[s("i",{staticClass:"icon icon-settings"})])],1),t._v(" "),s("div",{staticClass:"content font-14"},[s("van-list",{staticClass:"chat-list",attrs:{finished:t.chats.finished,offset:100,"immediate-check":!0},on:{load:t.onLoad},model:{value:t.chats.loading,callback:function(a){t.$set(t.chats,"loading",a)},expression:"chats.loading"}},[t._l(t.chats.data,function(a,e){return[s("van-swipe-cell",{attrs:{"right-width":70}},[s("router-link",{staticClass:"chat-item",attrs:{to:t.util.getUrl({path:"/pages/plugin/kefu/chat",query:{relation:a.relation,fansopenid:a.fansopenid}}),tag:"div"}},[s("div",{staticClass:"item-inner",class:{"van-hairline--top":e>0}},[s("div",{staticClass:"avatar"},[s("img",{staticClass:"img-100",attrs:{src:a.fansavatar,alt:""}})]),t._v(" "),s("div",{staticClass:"info"},[s("div",{staticClass:"flex-lr"},[s("div",{staticClass:"nickname ellipsis "},[t._v(t._s(a.fansnickname))]),t._v(" "),s("div",{staticClass:"lasttime ellipsis c-gray"},[t._v(t._s(a.lasttime_cn))])]),t._v(" "),s("div",{staticClass:"last-content w-100 ellipsis c-gray font-13"},[t._v(t._s(a.content))])]),t._v(" "),a.kefunotread>0?s("div",{staticClass:"not-read"},[t._v(t._s(a.kefunotread))]):t._e()])]),t._v(" "),s("span",{staticClass:"del-chat",attrs:{slot:"right"},on:{click:function(a){a.stopPropagation(),t.onCloseChat(e)}},slot:"right"},[t._v("删除")])],1)]})],2)],1),t._v(" "),t.showPreLoading?s("iloading"):t._e()],1)},staticRenderFns:[]};var o=s("VU/8")(n,l,!1,function(t){s("z5M8")},null,null);a.default=o.exports},z5M8:function(t,a){}});